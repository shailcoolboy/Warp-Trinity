<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">	<meta name="generator" content="ScreenSteps http://www.screensteps.com/" />	<title>Creating the Model</title>	<link href="../neutral.css" media="screen" rel="stylesheet" type="text/css" /></head><body class="lucida">	<div id="wrapper">				<div id="header">			<a id="logo" href="http://warp.rice.edu/trac/"><img src="http://warp.rice.edu/images/warpLogo.jpg" alt="Rice University WARP - Wireless Open-Access Research Platform" height="45" width="285" /></a>		</div>	<div id="mainnav" class="nav">		<ul>			<li class="first active"><a href="/trac/wiki">Home</a></li><li><a href="/forums">Forums</a></li><li><a href="/trac/browser">Browse Source</a></li>		</ul>	</div>		<div id="LessonContent">			<div class="LessonHeader">				<h1 class="LessonTitle">Creating the Model</h1>			</div>				<div class="summary">		<p>The steps to create the model are described in this section. At the end the entire DDS model will be complete and ready for simulation.</p>	</div>							<div id="step_1" class="lessonStep top">	    		<div class="image"><img src="images/Creating_the_Model/media_1222029457018.png" width="560" height="319"></div> <p>Open <strong>MATLAB 2007a</strong>.</p>	</div>	<div class="clear"></div>	<div id="step_2" class="lessonStep top">	    		<div class="image"><img src="images/Creating_the_Model/media_1222029980844.png" width="244" height="179"></div> <p>Open the <strong>Simulink Library</strong> browser by typing <strong>'simulink'</strong> on the MATLAB Command Window.</p>	</div>	<div class="clear"></div>	<div id="step_3" class="lessonStep top">	    		<div class="image"><img src="images/Creating_the_Model/media_1222029990559.png" width="486" height="802"></div> <p>This should open a browser that looks like the above picture. Notice that there is a WARP Blockset. If you do not see this in your library, re-visit the instructions on installing the WARP user repository at http://warp.rice.edu/trac.</p>	</div>	<div class="clear"></div>	<div id="step_4" class="lessonStep top">	    		<div class="image"><img src="images/Creating_the_Model/media_1222030014885.png" width="313" height="170"></div> <p>Open a new model by clicking <strong>New </strong>-&gt; <strong>Model</strong> in the Simulink Library Browser. This should open a blank canvas where the new design will be built.</p>	</div>	<div class="clear"></div>	<div id="step_5" class="lessonStep top">	    		<div class="image"><img src="images/Creating_the_Model/media_1222030135166.png" width="486" height="802"></div> <p>Expand the Xilinx Blockset by clicking the plus (+) sign next to it. These are the blocks that we will use to create the custom peripherals as they can be generated into HDL code. Only blocks with a white <strong>X</strong> are valid for generation.</p>	</div>	<div class="clear"></div>	<div id="step_6" class="lessonStep top">	    		<div class="image"><img src="images/Creating_the_Model/media_1222047713686.png" width="560" height="410"></div> <p>Drag in a <strong>System Generator</strong> block. This is required at the top-level in every Sysgen design. It has the system parameters such as simulation sampling period and corresponding clock frequency. This also has the options to generate HDL.</p><p>Save the model as <strong>ddsexample.mdl</strong> in a folder that does not contain spaces. For example, 'C:\Documents and Settings\User\Desktop' is <strong>not</strong> a valid location while 'C:\WARP_Tutorial\Peripherals' is valid.</p>	</div>	<div class="clear"></div>	<div id="step_7" class="lessonStep top">	    		<div class="image"><img src="images/Creating_the_Model/media_1222047790362.png" width="560" height="410"></div> <p>Drag in an <strong>Accumulator</strong> Block. This will increment a phase value to feed to the LUT.</p>	</div>	<div class="clear"></div>	<div id="step_8" class="lessonStep top">	    		<div class="image"><img src="images/Creating_the_Model/media_1222047804688.png" width="403" height="512"></div> <p>Double-click the block to open the options window. Set it up as shown above. The synchronous reset port will not be needed and choose 32 bits for the data to maintain high-precision.</p>	</div>	<div class="clear"></div>	<div id="step_9" class="lessonStep top">	    		<div class="image"><img src="images/Creating_the_Model/media_1222047869971.png" width="560" height="410"></div> <p>Drag in a <strong>Slice</strong> block. We are going to use a LUT to store the sine and cosine waves, but they will only be 2^12 deep. So we need to slice off the top 12 bits of the Accumulator to feed into the address port of the LUT.</p>	</div>	<div class="clear"></div>	<div id="step_10" class="lessonStep top">	    		<div class="image"><img src="images/Creating_the_Model/media_1222047899012.png" width="485" height="431"></div> <p>In the options for the Slice, set the width to be 12 and MSB input. This will slice 12 bits from the top of the word.</p>	</div>	<div class="clear"></div>	<div id="step_11" class="lessonStep top">	    		<div class="image"><img src="images/Creating_the_Model/media_1222048048007.png" width="560" height="410"></div> <p>Drag in 2 <strong>ROM</strong> blocks. These will serve as the LUT that store the sine and cosine waves. Rename the blocks as <strong>SIN</strong> and <strong>COS</strong> to diambiguate them.</p>	</div>	<div class="clear"></div>	<div id="step_12" class="lessonStep top">	    		<div class="image"><img src="images/Creating_the_Model/media_1222048088286.png" width="384" height="363"></div> <p>In the options for the SIN block, the depth should be set as <strong>2^12</strong> as thats the number of sample we want to store. The Initial Value Vector must be set one complete sine wave.</p>	</div>	<div class="clear"></div>	<div id="step_13" class="lessonStep top">	    		<div class="image"><img src="images/Creating_the_Model/media_1222051041794.png" width="384" height="363"></div> <p>In the Output Type tab, make sure to set the output for <strong>Signed</strong> with <strong>16</strong> bits and binary point at <strong>15</strong>. This should give us sufficient precision for the waves.</p>	</div>	<div class="clear"></div>	<div id="step_14" class="lessonStep top">	    		<div class="image"><img src="images/Creating_the_Model/media_1222048113159.png" width="384" height="363"></div> <p>Similarly for the COS, the Initial Value vector must the cosine wave. Remember to set the precision as well just like the sine wave.</p>	</div>	<div class="clear"></div>	<div id="step_15" class="lessonStep top">	    		<div class="image"><img src="images/Creating_the_Model/media_1222048166873.png" width="560" height="410"></div> <p>In order to drive the Accumulator, we need a constant phase increment input. This will be done using the <strong>From Register</strong> Block. The idea is that given a constant phase increment, the accumulator will loop through the values stored in the ROM at that rate. If the phase increment value is high, the sine and cosine wave outputs will have a higher frequency, while if the value is low, the output freqency will be low as well.</p>	</div>	<div class="clear"></div>	<div id="step_16" class="lessonStep top">	    		<div class="image"><img src="images/Creating_the_Model/media_1222048218833.png" width="417" height="289"></div> <p>Setup the From Register by giving it the name <strong>phaseInc</strong>. Set the Initial Value to <strong>1</strong>. Set the register to be <strong>Locally owned and initialized</strong>.</p>	</div>	<div class="clear"></div>	<div id="step_17" class="lessonStep top">	    		<div class="image"><img src="images/Creating_the_Model/media_1222048227464.png" width="417" height="289"></div> <p>Also for the Output type, we can take an input up to <strong>32</strong> bits as that is the width of the Accumulator. However, this time we want it to be <strong>Unsigned</strong> as we will like only positive increment values.</p>	</div>	<div class="clear"></div>	<div id="step_18" class="lessonStep top">	    		<div class="image"><img src="images/Creating_the_Model/media_1222048326430.png" width="560" height="410"></div> <p>The output of the ROM blocks varies between 1 and -1. That is the extent that the DAC can output. To avoid hitting the rails, the output must be scaled. Use a <strong>Scale</strong> block on the output of the ROMs.</p>	</div>	<div class="clear"></div>	<div id="step_19" class="lessonStep top">	    		<div class="image"><img src="images/Creating_the_Model/media_1222048333757.png" width="372" height="246"></div> <p>Set the block to scale by <strong>2^-1</strong>. Now the output should vary between -0.5 and 0.5. </p>	</div>	<div class="clear"></div>	<div id="step_20" class="lessonStep top">	    		<div class="image"><img src="images/Creating_the_Model/media_1222048565536.png" width="560" height="410"></div> <p>Before passing the sine and cosine values to the DAC, lets add a <strong>Register</strong> so we can reset the output if needed.</p>	</div>	<div class="clear"></div>	<div id="step_21" class="lessonStep top">	    		<div class="image"><img src="images/Creating_the_Model/media_1222048582499.png" width="384" height="248"></div> <p>Check the <strong>synchronous reset port</strong> box that can be asserted using a register.</p>	</div>	<div class="clear"></div>	<div id="step_22" class="lessonStep top">	    		<div class="image"><img src="images/Creating_the_Model/media_1222048818650.png" width="560" height="410"></div> <p>Add a <strong>From Register</strong> block and a <strong>Convert</strong> block to connect to the reset ports of the registers. The From Register can only output Unsigned or Signed, but the reset requires a Boolean input. This will be done by the Convert block.</p>	</div>	<div class="clear"></div>	<div id="step_23" class="lessonStep top">	    		<div class="image"><img src="images/Creating_the_Model/media_1222048839986.png" width="417" height="289"></div> <p>Name the From Register <strong>outputReset</strong>. Make sure the initial value is <strong>0</strong> so the system is not in reset by default.</p>	</div>	<div class="clear"></div>	<div id="step_24" class="lessonStep top">	    		<div class="image"><img src="images/Creating_the_Model/media_1222048845063.png" width="417" height="289"></div> <p>Change the output type of the From Register to <strong>Unsigned</strong> with <strong>1</strong> bit.</p>	</div>	<div class="clear"></div>	<div id="step_25" class="lessonStep top">	    		<div class="image"><img src="images/Creating_the_Model/media_1222048826553.png" width="497" height="389"></div> <p>For the Convert block, change the output type to <strong>Boolean</strong>.</p>	</div>	<div class="clear"></div>	<div id="step_26" class="lessonStep top">	    		<div class="image"><img src="images/Creating_the_Model/media_1222048898711.png" width="486" height="802"></div> <p>The last step is to add DACs. Two pairs of DACs will connect to both outputs; one forwarding the data to the Analog Board and the other to the Radio Board.</p><p>To add the DAC blocks, expand the <strong>WARP Blockset</strong>.</p>	</div>	<div class="clear"></div>	<div id="step_27" class="lessonStep top">	    		<div class="image"><img src="images/Creating_the_Model/media_1222049058578.png" width="560" height="410"></div> <p>Drag in <strong>Analog 4 DAC 1A </strong>and <strong>Analog 4 DAC 1B</strong>. The 4 is because the Analog Daughtercard is normally in slot 4, while 1A and 1B correspond to the DAC outputs on the daughtercard.</p>	</div>	<div class="clear"></div>	<div id="step_28" class="lessonStep top">	    		<div class="image"><img src="images/Creating_the_Model/media_1222049098799.png" width="560" height="410"></div> <p>Connect the output of your system to Radio blocks as well. Thus this model can be connected to the Analog Board or Radio Board. Drag in <strong>Radio 2 DAC I</strong> and <strong>Radio 2 DAC Q</strong>. Remember to connect the sine to the Q channel and the cosine to I channel.</p>	</div>	<div class="clear"></div>	<div id="step_29" class="lessonStep top">	    		<div class="image"><img src="images/Creating_the_Model/media_1222050230364.png" width="560" height="365"></div> <p>Finally, drag in <strong>Bus Creator</strong> and <strong>Scope</strong> blocks and connect the Analog Board outputs to them. This well help in simulation.</p><p>At this time, the model itself is complete. Next we will test and simulate model before generating the HDL corresponding to it.</p>	</div>	<div class="clear"></div>		</div>		<div id="lessonNavigation">			<table>				<tr>					<td class="lessonNav_Left"><a href="Requirements.html">&lt;&lt; Requirements</a></td>					<td class="lessonNav_TOC"><a href="../Custom_Peripherals.html">Top</a></td>					<td class="lessonNav_Right"><a href="Simulating_the_Design.html">Simulating the Design &gt;&gt;</a> </td>				</tr>			</table>		</div>	</div>	</body></html>